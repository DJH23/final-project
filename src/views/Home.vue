<template>
  <div id="flexbox">
    <div id="app" data-v-app="">
      <div class="min-h-min">
        <nav class="bg-white border-yellow-500 bg-purple-100/90 px-2 sm:px-4 py-4 rounded ">
          <div class="container flex flex-wrap justify-between items-center mx-auto"><a aria-current="page" href="/"
              class="router-link-active router-link-exact-active flex items-center">
              <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="100" height="100" viewBox="0 0 160 160" xml:space="preserve">
<desc>Created with Fabric.js 3.6.3</desc>
<defs>
</defs>
<g transform="matrix(0.3 0 0 0.3 81.45 81.45)"  >
<g style=""   >
		<g transform="matrix(1 0 0 1 -160 -160)"  >
<path style="stroke: none; stroke-width: 1; stroke-dasharray: none; stroke-linecap: butt; stroke-dashoffset: 0; stroke-linejoin: miter; stroke-miterlimit: 4; fill: rgb(234 179 8); fill-rule: nonzero; opacity: 1;"  transform=" translate(-71.5, -71.5)" d="M 71.5 0 C 32.075 0 0 32.075 0 71.5 S 32.075 143 71.5 143 S 143 110.925 143 71.5 S 110.925 0 71.5 0 z M 71.5 128 C 40.346 128 15 102.654 15 71.5 S 40.346 15 71.5 15 S 128 40.346 128 71.5 S 102.654 128 71.5 128 z" stroke-linecap="round" />
</g>
		<g transform="matrix(1 0 0 1 -160 0)"  >
<path style="stroke: none; stroke-width: 1; stroke-dasharray: none; stroke-linecap: butt; stroke-dashoffset: 0; stroke-linejoin: miter; stroke-miterlimit: 4; fill: rgb(234 179 8); fill-rule: nonzero; opacity: 1;"  transform=" translate(-71.5, -231.5)" d="M 71.5 160 C 32.075 160 0 192.075 0 231.5 S 32.075 303 71.5 303 s 71.5 -32.075 71.5 -71.5 S 110.925 160 71.5 160 z M 71.5 288 C 40.346 288 15 262.654 15 231.5 S 40.346 175 71.5 175 s 56.5 25.346 56.5 56.5 S 102.654 288 71.5 288 z" stroke-linecap="round" />
</g>
		<g transform="matrix(1 0 0 1 -160 160)"  >
<path style="stroke: none; stroke-width: 1; stroke-dasharray: none; stroke-linecap: butt; stroke-dashoffset: 0; stroke-linejoin: miter; stroke-miterlimit: 4; fill: rgb(168 85 247); fill-rule: nonzero; opacity: 1;"  transform=" translate(-71.5, -391.5)" d="M 71.5 320 C 32.075 320 0 352.075 0 391.5 S 32.075 463 71.5 463 s 71.5 -32.075 71.5 -71.5 S 110.925 320 71.5 320 z M 71.5 448 C 40.346 448 15 422.654 15 391.5 S 40.346 335 71.5 335 s 56.5 25.346 56.5 56.5 S 102.654 448 71.5 448 z" stroke-linecap="round" />
</g>
		<g transform="matrix(1 0 0 1 -160 -160)"  >
<path style="stroke: none; stroke-width: 1; stroke-dasharray: none; stroke-linecap: butt; stroke-dashoffset: 0; stroke-linejoin: miter; stroke-miterlimit: 4; fill: rgb(168 85 247); fill-rule: nonzero; opacity: 1;"  transform=" translate(-71.5, -71.5)" d="m 90.196 50.197 l -26.696 26.697 l -10.696 -10.697 c -2.93 -2.929 -7.678 -2.929 -10.607 0 s -2.929 7.678 0 10.606 l 16 16 c 1.464 1.465 3.384 2.197 5.303 2.197 s 3.839 -0.732 5.304 -2.197 l 32 -32 c 2.929 -2.929 2.929 -7.678 0 -10.606 c -2.93 -2.929 -7.678 -2.929 -10.608 7.10543e-15 z" stroke-linecap="round" />
</g>
		<g transform="matrix(1 0 0 1 -160 0)"  >
<path style="stroke: none; stroke-width: 1; stroke-dasharray: none; stroke-linecap: butt; stroke-dashoffset: 0; stroke-linejoin: miter; stroke-miterlimit: 4; fill: rgb(168 85 247); fill-rule: nonzero; opacity: 1;"  transform=" translate(-71.5, -231.5)" d="m 90.196 210.197 l -26.696 26.697 l -10.696 -10.697 c -2.93 -2.929 -7.678 -2.929 -10.607 0 s -2.929 7.678 0 10.606 l 16 16 c 1.464 1.465 3.384 2.197 5.303 2.197 s 3.839 -0.732 5.304 -2.197 l 32 -32 c 2.929 -2.929 2.929 -7.678 0 -10.606 c -2.93 -2.929 -7.678 -2.929 -10.608 0 z" stroke-linecap="round" />
</g>
		<g transform="matrix(1 0 0 1 16 -184)"  >
<path style="stroke: none; stroke-width: 1; stroke-dasharray: none; stroke-linecap: butt; stroke-dashoffset: 0; stroke-linejoin: miter; stroke-miterlimit: 4; fill: rgb(168 85 247); fill-rule: nonzero; opacity: 1;"  transform=" translate(-247.5, -47.5)" d="m 175.5 55 h 144 c 4.143 0 7.5 -3.358 7.5 -7.5 s -3.357 -7.5 -7.5 -7.5 h -144 c -4.143 0 -7.5 3.358 -7.5 7.5 s 3.357 7.5 7.5 7.5 z" stroke-linecap="round" />
</g>
		<g transform="matrix(1 0 0 1 84 -136)"  >
<path style="stroke: none; stroke-width: 1; stroke-dasharray: none; stroke-linecap: butt; stroke-dashoffset: 0; stroke-linejoin: miter; stroke-miterlimit: 4; fill: rgb(168 85 247); fill-rule: nonzero; opacity: 1;"  transform=" translate(-315.5, -95.5)" d="m 175.5 103 h 280 c 4.143 0 7.5 -3.358 7.5 -7.5 s -3.357 -7.5 -7.5 -7.5 h -280 c -4.143 0 -7.5 3.358 -7.5 7.5 s 3.357 7.5 7.5 7.5 z" stroke-linecap="round" />
</g>
		<g transform="matrix(1 0 0 1 16 -24)"  >
<path style="stroke: none; stroke-width: 1; stroke-dasharray: none; stroke-linecap: butt; stroke-dashoffset: 0; stroke-linejoin: miter; stroke-miterlimit: 4; fill: rgb(168 85 247); fill-rule: nonzero; opacity: 1;"  transform=" translate(-247.5, -207.5)" d="m 175.5 215 h 144 c 4.143 0 7.5 -3.358 7.5 -7.5 s -3.357 -7.5 -7.5 -7.5 h -144 c -4.143 0 -7.5 3.358 -7.5 7.5 s 3.357 7.5 7.5 7.5 z" stroke-linecap="round" />
</g>
		<g transform="matrix(1 0 0 1 84 24)"  >
<path style="stroke: none; stroke-width: 1; stroke-dasharray: none; stroke-linecap: butt; stroke-dashoffset: 0; stroke-linejoin: miter; stroke-miterlimit: 4; fill: rgb(168 85 247); fill-rule: nonzero; opacity: 1;"  transform=" translate(-315.5, -255.5)" d="m 455.5 248 h -280 c -4.143 0 -7.5 3.358 -7.5 7.5 s 3.357 7.5 7.5 7.5 h 280 c 4.143 0 7.5 -3.358 7.5 -7.5 s -3.357 -7.5 -7.5 -7.5 z" stroke-linecap="round" />
</g>
		<g transform="matrix(1 0 0 1 16 136)"  >
<path style="stroke: none; stroke-width: 1; stroke-dasharray: none; stroke-linecap: butt; stroke-dashoffset: 0; stroke-linejoin: miter; stroke-miterlimit: 4; fill: rgb(234 179 8); fill-rule: nonzero; opacity: 1;"  transform=" translate(-247.5, -367.5)" d="m 175.5 375 h 144 c 4.143 0 7.5 -3.358 7.5 -7.5 s -3.357 -7.5 -7.5 -7.5 h -144 c -4.143 0 -7.5 3.358 -7.5 7.5 s 3.357 7.5 7.5 7.5 z" stroke-linecap="round" />
</g>
		<g transform="matrix(1 0 0 1 84 184)"  >
<path style="stroke: none; stroke-width: 1; stroke-dasharray: none; stroke-linecap: butt; stroke-dashoffset: 0; stroke-linejoin: miter; stroke-miterlimit: 4; fill: rgb(234 179 8); fill-rule: nonzero; opacity: 1;"  transform=" translate(-315.5, -415.5)" d="m 455.5 408 h -280 c -4.143 0 -7.5 3.358 -7.5 7.5 s 3.357 7.5 7.5 7.5 h 280 c 4.143 0 7.5 -3.358 7.5 -7.5 s -3.357 -7.5 -7.5 -7.5 z" stroke-linecap="round" />
</g>
</g>
</g>
</svg></a><button data-collapse-toggle="mobile-menu" type="button"
              class="inline-flex items-center p-2 ml-3 text-sm text-yellow-500 rounded-lg md:hidden hover:bg-green-100 focus:outline-none focus:ring-2 focus:ring-green-800 dark:text-gray-400 dark:hover:bg-gray-700 dark:focus:ring-gray-600"
              aria-controls="mobile-menu" aria-expanded="false"><span class="sr-only">Open main menu</span>
              <svg
                class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                <path fill-rule="evenodd"
                  d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z"
                  clip-rule="evenodd"></path>
              </svg>
              <svg class="hidden w-6 h-6" fill="currentColor" viewBox="0 0 20 20"
                xmlns="http://www.w3.org/2000/svg">
                <path fill-rule="evenodd"
                  d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z"
                  clip-rule="evenodd"></path>
              </svg>
            </button>
            <div class="hidden w-full md:block md:w-auto" id="mobile-menu">
              <ul class="flex flex-col mt-4 md:flex-row md:space-x-8 md:mt-0 md:text-sm md:font-medium">
                <li class="flex items-center justify-center">
                  <p href="#"
                    class="text-center block py-2 pr-4 pl-3 text-gray-700 rounded md:bg-transparent md:p-0 dark:text-black">
                    Welcome Back <span class="font-bold"> {{ userName }}</span></p>
                </li>
                <li class="flex justify-center pt-4 md:pt-0"><button
                    class="ml-8 inline-block py-2 px-4 text-sm leading-5 text-white bg-yellow-500 hover:bg-purple-500 ease-in-out duration-300 font-medium focus:ring-2 focus:ring-purple-500 focus:ring-opacity-50 rounded-md"
                    type="submit"> Log Out </button></li>
              </ul>
            </div>
          </div>
        </nav>
        <section class="pt-4 bg-purple-200/50">
          <div class="container px-4 mx-auto">
            <div class="max-w-4xl mx-auto text-center animate__animated animate__fadeIn">
              <span class="inline-block py-px px-2 mb-4 text-xs leading-5 text-purple-500 bg-yellow-500/25 font-medium rounded-full shadow-sm">TASK</span>
              <h2 class="mb-4 text-4xl md:text-5xl leading-tight text-coolGray-900 font-bold tracking-tighter"> Add a
                new <span class="text-yellow-500">Task<span class="text-purple-500">app</span></span></h2>
              <p class="text-lg md:text-xl text-coolGray-500 font-medium"> Keep your life organised</p>  
                 <div class="flex justify-center">
              <ul class="list-disc marker:text-yellow-500 mt-8 list-inside text-left text-xl">
                    <li>Preparing for a trip?</li>  
                    <li>Got a project coming up?</li>  
                    <li>Start planning right here</li>  
                  </ul>
                </div>
              <p class="mb-10 mt-8 text-lg text-coolGray-500 font-medium"> Today's Date is Oct 4th 2022</p>
              <div class="flex justify-center my-2 mx-4 md:mx-0">
              <form class="w-full max-w-xl bg-white rounded-lg shadow-md p-6 ">
              
                <div class="flex flex-col px-4"><input class="inputField mb-4 appearance-none block w-full bg-yellow-500/25 text-gray-900 font-medium border border-gray-400 rounded-lg py-3 px-3 leading-tight focus:outline-none focus:bg-purple-500/25 ease-in-out duration-300 "
                    placeholder="Add a Task Title - e.g. Arrange business trip" type="text" name="newTodo"
                    id="name"><input class="inputField mb-4 appearance-none block w-full bg-yellow-500/25 text-gray-900 font-medium border border-gray-400 rounded-lg py-3 px-3 leading-tight focus:outline-none focus:bg-purple-500/25 ease-in-out duration-300"
                    placeholder="Add a Task Decription - Confirm dates, book room and flights"
                    type="text" name="newDescription" id="description"><button
                    class="appearance-none block w-full bg-yellow-500/25 text-gray-400 font-medium border border-gray-400 rounded-lg py-3 px-3 leading-tight focus:outline-none focus:bg-purple-500/25 ease-in-out duration-300"
                    type="submit"> Add </button></div>
              
              </form>
            </div>
              <!---->
            </div>
            <!---->
            <div class="flex flex-wrap -mx-4 mt-24"></div>
            <div id="defaultModal" tabindex="-1" aria-hidden="true"
              class="hidden overflow-y-auto overflow-x-hidden fixed top-0 right-0 left-0 z-50 w-full md:inset-0 h-modal md:h-full">
              <div class="relative p-4 w-full max-w-2xl h-full md:h-auto">
                <div class="relative bg-white rounded-lg shadow dark:bg-gray-700">
                  <div class="flex justify-between items-start p-5 rounded-t border-b dark:border-gray-600">
                    <h3 class="text-xl font-semibold text-gray-900 lg:text-2xl dark:text-white"> Delete All Tasks </h3>
                    <button type="button"
                      class="text-gray-400 bg-transparent hover:bg-gray-200 hover:text-gray-900 rounded-lg text-sm p-1.5 ml-auto inline-flex items-center dark:hover:bg-gray-600 dark:hover:text-white"
                      data-modal-toggle="defaultModal"><svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20"
                        xmlns="http://www.w3.org/2000/svg">
                        <path fill-rule="evenodd"
                          d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z"
                          clip-rule="evenodd"></path>
                      </svg></button>
                  </div>
                  <div class="p-6 space-y-6">
                    <p class="text-base leading-relaxed text-gray-500 dark:text-gray-400"> Are you sure you want to
                      delete all of your tasks? </p>
                  </div>
                  <div class="flex items-center p-6 space-x-2 rounded-b border-t border-gray-200 dark:border-gray-600">
                    <button type="button"
                      class="text-white bg-red-500 hover:bg-red-600 focus:ring-4 focus:outline-none font-medium rounded-lg text-sm px-5 py-2.5 text-center">
                      Delete All Tasks </button><button data-modal-toggle="defaultModal" type="button"
                      class="text-gray-500 bg-white hover:bg-gray-100 focus:ring-4 focus:outline-none focus:ring-blue-300 rounded-lg border border-gray-200 text-sm font-medium px-5 py-2.5 hover:text-gray-900 focus:z-10 dark:bg-gray-700 dark:text-gray-300 dark:border-gray-500 dark:hover:text-white dark:hover:bg-gray-600 dark:focus:ring-gray-600">
                      Cancel </button></div>
                </div>
              </div>
            </div>
          </div>
        </section>
        <section class="bg-purple-100/90">
          <!-- <div class="container px-4 mx-auto">
            <div class="mx-auto max-w-4xl"><a class="block md:mx-auto mb-5 max-w-max pt-4" href="#"><a
                  aria-current="page" href="/"
                  class="router-link-active router-link-exact-active flex items-center"><img
                    src="https://res.cloudinary.com/dnsnkrcru/image/upload/v1648481844/taskApp/imgs/logo-small_bh8xj2.svg"
                    class="mr-3 h-6 sm:h-9" alt="Flowbite Logo"></a></a>
              <div class="flex flex-wrap justify-center -mx-3 lg:-mx-6"></div>
            </div>
          </div> -->
          <div class="border-b border-coolGray-100"></div>
          <div class="container px-4 mx-auto">
            <p class="py-10 md:pb-20 text-lg md:text-xl text-coolGray-400 font-medium text-center"> © 2022 TaskApp. All
              rights reserved.</p>
          </div>
        </section>
      </div>
    </div>
    <!-- <div class="flexbox_element">
      <div>You are signed in as {{ userName }}</div>

      <NewTask @childNewTask="sendToStore" />
      <br />
      <p>Total tasks: {{ taskArray.length }}</p>
    </div>
    <div id="todoTasks" class="flexbox_element">
      <TodoTasks />
      <ol>
        <TaskItem
          v-for="(task, index) in taskArray"
          :key="index"
          :taskData="task"
        ></TaskItem>
      </ol>
    </div>
    <div id="doneTasks" class="flexbox_element"><DoneTasks /></div>
  </div> -->
  </div>
</template>

<script setup>
import NewTask from "@/components/NewTask.vue";
import { useTaskStore } from "../stores/task.js";
import TaskItem from "../components/TaskItem.vue";
import { ref } from "vue";
// import TodoTasks from "../components/TodoTasks.vue";
// import DoneTasks from "../components/DoneTasks.vue";
//coger el email del usuario
import { useUserStore } from "@/stores/user.js";
let userName = ref(useUserStore().user.email);
// nos definimos la tienda del usuario dentro de una constante
const taskStore = useTaskStore();
// Inicializamos array de tareas
let taskArray = ref([]);
async function readFromStore() {
  taskArray.value = await taskStore.fetchTasks();
}
readFromStore();
// Enviamos los datos de la tarea a la Tienda taskStore
async function sendToStore(title, description) {
  await taskStore.addTask(title, description);
  readFromStore();
}
// async function readAll() {
//   let { data: tasks, error } = await supabase.from("tasks").select("*");
// }
// readAll();
</script>
<style scoped>
#todoTasks {
  background-color: rgb(33, 35, 118);
  color: white;
}

#doneTasks {
  background-color: rgb(41, 93, 41);
  color: white;
}
</style>

<!-- 
**Hints**
1. ref() is used here!
2. (NewTask, TaskItem, Footer, Nav) components are used here! 
3. Tasks are going to be contained in an array here!
4. An async function is needed to get all of the tasks stored within the supabase database, this async function's body will contain the tasks value which be use to store the fetchTasks method which lives inside the userTaskStore. This function needs to be called within the setUp script in order to run within the first instance of this component lifecycle.
5. NewTask component will receive a customEvent on this instance of the homeView that will fire the add-to-do function
6. add-to-do function will receive 2 params/arguments that will tak a taskTitle and a taskDescription and the body of this async function will call the taskStore that calls the addTask function from the store that pushes the info of the task to the backEnd. This is possible by passing the 2 param/arguments that will be passed by the user from the inputs within the NewTask Component. 
7. TaskItem component will loop through the tasks-array that will print an individual instance of an individual TaskItem component. TaskItem will receive 3 customEvents on this instance of the homeView. 1 customEvent for toggling the task to show either a text or an icon to display if the task is completed or not completed. 1 customEevent for removing/deleting the task out of the array. 1 customEvent for editing the task title and description. This function needs to call the function mentioned on hint4.
7.1-customEvent will fire an async function that will take in 1 param/argument. On the body of this function the param/argument will be used to define 2 constants. 1 of this constants will take care of setting the boolean value to the opposite of the value that checks wether this task is_complete. 1 of this constants will take of calling the id of this specific task in order to call the right id. 
7.2-customEvent will fire an asynf function that will take in 1 param/argument. This async function's body will be used to call the deleteTaskmethod which will take the param/argument's id in order to delete the task. This function needs to call the function mentioned on hint4. 
7.3-customEvent will fire an async function that will take in 1 param/argument. this async function's body will be used to take in 2 constants. 1 constant will take in the param/argument newValue. 1 constant will be used to get the param/argument oldValue id. These 2 constants will be sent to the backend via the useTaskStore which holds an editTask method. This function needs to call the function mentioned on hint4.
-->
